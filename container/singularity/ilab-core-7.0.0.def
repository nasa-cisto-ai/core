## Generate core container with ilab-specific dependencies that builds on the Python ecosystem container
Bootstrap: localimage
FROM: ./cisto-data-science-3.0.0.simg
%labels
    Author gtamkin
    Version v1.0.0

%help
===========================================================================
	- ilab-core (extends -> python3-data-science) â€“ contains GIS & ilab dependencies:
		a.	GDAL
		b.	Celery
		c.  Redis (Celery server)
===========================================================================

%environment
    # set PYTHONPATH for access to ILProcessController
    export PYTHONPATH="$PYTHONPATH:/usr/local/core"

%post

    # install GDAL 2.2.2 (as per Roger's request for EVHR)
    wget http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2.tar.gz
    tar -xvzf gdal-2.2.2.tar.gz
    cd gdal-2.2.2

    ./configure --prefix=/usr
    make

    apt-get install checkinstall
    checkinstall

    gdal-config --version
    python -c 'from osgeo import gdal; print(gdal.__version__)'
